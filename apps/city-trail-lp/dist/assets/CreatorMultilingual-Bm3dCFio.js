import{u as je,r as x,j as e,s as N}from"./index-VJX5zWq_.js";import{T as fe}from"./TomoshibiLogo-BVN6SfG2.js";import{c as te}from"./createLucideIcon-Dxvw1eg7.js";import{a as ee,C as q}from"./chevron-down-t5OWlCYu.js";import{B as Ne,U as ve,M as _e}from"./users-DCMXpzDX.js";import{M as se}from"./message-circle-DxUchsAL.js";import{G as ye}from"./globe-b8VqUKjr.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],z=te("chevron-up",we);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],Se=te("languages",ke),M=[{code:"en",name:"è‹±èª",flag:"ğŸ‡ºğŸ‡¸"},{code:"ko",name:"éŸ“å›½èª",flag:"ğŸ‡°ğŸ‡·"}];function Te(){var K,R,V,Y,H,W,X;const $=je(),[v,ne]=x.useState(null),[ae,D]=x.useState(!0),[b,G]=x.useState([]),[l,O]=x.useState("ja"),[C,re]=x.useState(null),[a,le]=x.useState(null),[f,oe]=x.useState([]),[_,ie]=x.useState([]),[F,J]=x.useState({}),[y,ce]=x.useState([]),[g,de]=x.useState({basic:!0,story:!0,spots:!1,characters:!1,conversations:!0}),[P,xe]=x.useState({}),[E,Q]=x.useState(!1),[U,B]=x.useState(null),[me,Z]=x.useState(!1);x.useEffect(()=>{(async()=>{D(!0);const t=localStorage.getItem("creatorQuestId")||localStorage.getItem("quest-id");if(t){ne(t);const d=localStorage.getItem(`quest-languages:${t}`);if(d)try{const c=JSON.parse(d),m=[];c.includes("è‹±èª")&&m.push("en"),c.includes("éŸ“å›½èª")&&m.push("ko"),G(m)}catch(c){console.error("Failed to parse saved languages",c)}const{data:i}=await N.from("quests").select("*").eq("id",t).single();i&&re({id:i.id,title:i.title||"",description:i.description||"",area_name:i.area_name||"",difficulty:i.difficulty||"",target_audience:i.target_audience||""});const{data:n}=await N.from("story_timelines").select("prologue, epilogue, prologue_title, cast_name, cast_tone, characters").eq("quest_id",t).single();n&&(le({prologue_title:n.prologue_title||"",prologue:n.prologue||"",epilogue:n.epilogue||"",cast_name:n.cast_name||"",cast_tone:n.cast_tone||"",characters:n.characters||[]}),n.characters&&Array.isArray(n.characters)&&ie(n.characters));const{data:p}=await N.from("spots").select("id, name, address, order_index").eq("quest_id",t).order("order_index");if(p&&p.length>0){const c=p.map(j=>j.id),{data:m}=await N.from("spot_details").select("spot_id, nav_text, story_text, question_text, hint_text, answer_text, completion_message").in("spot_id",c),T=p.map(j=>{const r=m==null?void 0:m.find(k=>k.spot_id===j.id),A=r!=null&&r.hint_text?r.hint_text.split(`
`).filter(k=>k.trim()):[];return{...j,story_intro:(r==null?void 0:r.story_text)||"",challenge_text:(r==null?void 0:r.question_text)||"",hints:A,answer:(r==null?void 0:r.answer_text)||"",success_message:(r==null?void 0:r.completion_message)||"",directions:(r==null?void 0:r.nav_text)||""}});oe(T);const{data:L}=await N.from("spot_story_messages").select("spot_id, message_type, sequence, speaker_type, speaker_name, message_text").in("spot_id",c).order("sequence");L&&ce(L)}const{data:w}=await N.from("quest_translations").select("lang, title, description").eq("quest_id",t);if(w&&w.length>0){const c={};for(const m of w)c[m.lang]={quest:i?{...i,title:m.title,description:m.description}:null,story:null,spots:[],characters:[]};J(c)}}D(!1)})()},[]);const pe=s=>{G(t=>t.includes(s)?t.filter(d=>d!==s):[...t,s])},I=s=>{de(t=>({...t,[s]:!t[s]}))},he=s=>{xe(t=>({...t,[s]:!t[s]}))},be=async()=>{var t,d,i,n,p,w;if(!v||b.length===0||!C)return;Q(!0),B(null),Z(!1);const s="AIzaSyD0wPNjJUvnhDTguxYLwl9NE_kFvEZZs1I";try{for(const c of b){const m=((t=M.find(h=>h.code===c))==null?void 0:t.name)||c,T={title:C.title,description:C.description,prologue_title:(a==null?void 0:a.prologue_title)||"",prologue:(a==null?void 0:a.prologue)||"",epilogue:(a==null?void 0:a.epilogue)||"",cast_name:(a==null?void 0:a.cast_name)||"",spots:f.map(h=>({id:h.id,name:h.name,story_intro:h.story_intro,challenge_text:h.challenge_text,hints:h.hints,success_message:h.success_message,directions:h.directions}))},L=`ã‚ãªãŸã¯ãƒ—ãƒ­ã®ç¿»è¨³è€…ã§ã™ã€‚ä»¥ä¸‹ã®æ—¥æœ¬èªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’${m}ã«ç¿»è¨³ã—ã¦ãã ã•ã„ã€‚
åœ°åã‚„å›ºæœ‰åè©ã¯é©åˆ‡ã«ç¿»è¨³ã¾ãŸã¯ãã®ã¾ã¾æ®‹ã—ã¦ãã ã•ã„ã€‚
ã‚²ãƒ¼ãƒ ã®è¬è§£ãã‚„ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãƒ†ãƒªãƒ³ã‚°ã®é›°å›²æ°—ã‚’ç¶­æŒã—ã¦ãã ã•ã„ã€‚

å…¥åŠ›ã‚³ãƒ³ãƒ†ãƒ³ãƒ„:
${JSON.stringify(T,null,2)}

ä»¥ä¸‹ã®JSONå½¢å¼ã§å‡ºåŠ›ã—ã¦ãã ã•ã„:
\`\`\`json
{
  "title": "ç¿»è¨³ã•ã‚ŒãŸã‚¿ã‚¤ãƒˆãƒ«",
  "description": "ç¿»è¨³ã•ã‚ŒãŸèª¬æ˜æ–‡",
  "prologue_title": "ç¿»è¨³ã•ã‚ŒãŸãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ã‚¿ã‚¤ãƒˆãƒ«",
  "prologue": "ç¿»è¨³ã•ã‚ŒãŸãƒ—ãƒ­ãƒ­ãƒ¼ã‚°",
  "epilogue": "ç¿»è¨³ã•ã‚ŒãŸã‚¨ãƒ”ãƒ­ãƒ¼ã‚°",
  "cast_name": "ç¿»è¨³ã•ã‚ŒãŸã‚­ãƒ£ã‚¹ãƒˆåã¾ãŸã¯åŸæ–‡ã®ã¾ã¾",
  "spots": [
    {
      "id": "ã‚¹ãƒãƒƒãƒˆIDï¼ˆå¤‰æ›´ã—ãªã„ï¼‰",
      "name": "ç¿»è¨³ã•ã‚ŒãŸã‚¹ãƒãƒƒãƒˆå",
      "story_intro": "ç¿»è¨³ã•ã‚ŒãŸã‚¹ãƒˆãƒ¼ãƒªãƒ¼å°å…¥",
      "challenge_text": "ç¿»è¨³ã•ã‚ŒãŸè¬ãƒ†ã‚­ã‚¹ãƒˆ",
      "hints": ["ç¿»è¨³ã•ã‚ŒãŸãƒ’ãƒ³ãƒˆ1", "ç¿»è¨³ã•ã‚ŒãŸãƒ’ãƒ³ãƒˆ2"],
      "success_message": "ç¿»è¨³ã•ã‚ŒãŸæˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸",
      "directions": "ç¿»è¨³ã•ã‚ŒãŸé“æ¡ˆå†…"
    }
  ]
}
\`\`\``,j=await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-3-flash-preview:generateContent?key=${s}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:L}]}]})});if(!j.ok)throw new Error(`API error: ${j.status}`);const r=await j.json(),A=((w=(p=(n=(i=(d=r==null?void 0:r.candidates)==null?void 0:d[0])==null?void 0:i.content)==null?void 0:n.parts)==null?void 0:p[0])==null?void 0:w.text)||"",k=A.match(/```json([\s\S]*?)```/),ge=k?k[1]:A,u=JSON.parse(ge.trim());J(h=>({...h,[c]:{quest:{...C,title:u.title,description:u.description},story:{prologue_title:u.prologue_title,prologue:u.prologue,epilogue:u.epilogue,cast_name:u.cast_name,cast_tone:(a==null?void 0:a.cast_tone)||"",characters:_},spots:u.spots.map((S,ue)=>({...f[ue],name:S.name,story_intro:S.story_intro,challenge_text:S.challenge_text,hints:S.hints||[],success_message:S.success_message,directions:S.directions})),characters:_}})),await N.from("quest_translations").upsert({quest_id:v,lang:c,title:u.title,description:u.description})}Z(!0)}catch(c){console.error("Translation error:",c),B(c.message||"ç¿»è¨³ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ")}finally{Q(!1)}},o=l==="ja"?{quest:C,story:a,spots:f,characters:_}:F[l]||{quest:null,story:null,spots:[],characters:[]};return ae?e.jsx("section",{className:"min-h-screen bg-stone-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-brand-gold border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-stone-500",children:"èª­ã¿è¾¼ã¿ä¸­..."})]})}):e.jsxs("section",{className:"min-h-screen bg-stone-50 flex flex-col",children:[e.jsx("div",{className:"bg-white/80 backdrop-blur-md border-b border-stone-200 sticky top-0 z-50",children:e.jsxs("div",{className:"container mx-auto px-4 md:px-8 py-3 flex items-center justify-between",children:[e.jsx("button",{onClick:()=>$("/"),className:"hover:opacity-80 transition-opacity",children:e.jsx(fe,{className:"h-7 w-auto"})}),e.jsxs("div",{className:"flex items-center gap-4 text-xs font-bold text-stone-400",children:[e.jsx("span",{className:"hidden md:inline",children:"Step 1: åŸºæœ¬æƒ…å ±"}),e.jsx("span",{children:"â€º"}),e.jsx("span",{className:"hidden md:inline",children:"Step 2: ã‚¹ãƒãƒƒãƒˆ"}),e.jsx("span",{children:"â€º"}),e.jsx("span",{className:"hidden md:inline",children:"Step 3: ã‚¹ãƒˆãƒ¼ãƒªãƒ¼"}),e.jsx("span",{children:"â€º"}),e.jsx("span",{className:"text-brand-dark px-2 py-1 bg-brand-gold/10 rounded",children:"Step 4: å¤šè¨€èª"}),e.jsx("span",{children:"â€º"}),e.jsx("span",{children:"Step 5: ç¢ºèª"}),e.jsx("span",{children:"â€º"}),e.jsx("span",{children:"Step 6: å…¬é–‹"})]})]})}),e.jsxs("div",{className:"flex-1 container mx-auto px-4 md:px-8 py-8 max-w-5xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("button",{onClick:()=>$("/creator/workspace"),className:"text-xs font-bold text-stone-500 hover:text-brand-dark flex items-center gap-1 transition-colors",children:[e.jsx("span",{className:"text-lg",children:"â€¹"})," ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«æˆ»ã‚‹"]}),e.jsx("h1",{className:"text-3xl font-serif font-bold text-brand-dark",children:"å¤šè¨€èªã‚ªãƒ¼ã‚µãƒªãƒ³ã‚°"})]}),e.jsxs("div",{className:"mb-8 p-6 bg-white rounded-2xl border border-stone-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white",children:e.jsx(Se,{size:20})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-brand-dark",children:"å¯¾å¿œè¨€èªã‚’é¸æŠ"}),e.jsx("p",{className:"text-sm text-stone-500",children:"ç¿»è¨³ã™ã‚‹è¨€èªã‚’é¸æŠã—ã¦ãã ã•ã„"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-stone-100 rounded-xl opacity-75",children:[e.jsx("div",{className:"w-5 h-5 rounded bg-brand-gold flex items-center justify-center",children:e.jsx(ee,{size:14,className:"text-white"})}),e.jsx("span",{className:"text-sm font-medium whitespace-nowrap",children:"ğŸ‡¯ğŸ‡µ æ—¥æœ¬èªï¼ˆãƒ™ãƒ¼ã‚¹ï¼‰"})]}),M.map(s=>e.jsxs("button",{onClick:()=>pe(s.code),className:`flex items-center gap-2 px-4 py-3 rounded-xl border transition-all ${b.includes(s.code)?"bg-brand-gold/10 border-brand-gold text-brand-dark":"bg-white border-stone-200 hover:border-brand-gold/50"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded flex items-center justify-center ${b.includes(s.code)?"bg-brand-gold":"border border-stone-300"}`,children:b.includes(s.code)&&e.jsx(ee,{size:14,className:"text-white"})}),e.jsxs("span",{className:"text-sm font-medium whitespace-nowrap",children:[s.flag," ",s.name]})]},s.code))]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-stone-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-stone-200",children:[e.jsx("button",{onClick:()=>O("ja"),className:`flex-1 px-4 py-3 text-sm font-bold transition-colors ${l==="ja"?"bg-brand-gold/10 text-brand-dark border-b-2 border-brand-gold":"text-stone-500 hover:bg-stone-50"}`,children:"ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª"}),b.map(s=>{var d;const t=M.find(i=>i.code===s);return e.jsxs("button",{onClick:()=>O(s),className:`flex-1 px-4 py-3 text-sm font-bold transition-colors ${l===s?"bg-brand-gold/10 text-brand-dark border-b-2 border-brand-gold":"text-stone-500 hover:bg-stone-50"}`,children:[t==null?void 0:t.flag," ",t==null?void 0:t.name,!((d=F[s])!=null&&d.quest)&&e.jsx("span",{className:"ml-2 text-xs text-orange-500",children:"ï¼ˆæœªç¿»è¨³ï¼‰"})]},s)})]}),e.jsxs("div",{className:"divide-y divide-stone-100",children:[e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>I("basic"),className:"w-full flex items-center justify-between px-6 py-4 hover:bg-stone-50 transition-colors",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:"font-bold text-brand-dark",children:"ğŸ“‹ åŸºæœ¬æƒ…å ±"})}),g.basic?e.jsx(z,{size:20}):e.jsx(q,{size:20})]}),g.basic&&e.jsx("div",{className:"px-6 pb-6 space-y-4",children:o.quest?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-stone-50 rounded-xl",children:[e.jsx("label",{className:"text-xs font-bold text-stone-500 mb-1 block",children:"ã‚¿ã‚¤ãƒˆãƒ«"}),e.jsx("p",{className:"text-lg font-bold text-brand-dark",children:o.quest.title||"ï¼ˆæœªè¨­å®šï¼‰"})]}),e.jsxs("div",{className:"p-4 bg-stone-50 rounded-xl",children:[e.jsx("label",{className:"text-xs font-bold text-stone-500 mb-1 block",children:"ã‚¨ãƒªã‚¢"}),e.jsx("p",{className:"text-sm",children:o.quest.area_name||"ï¼ˆæœªè¨­å®šï¼‰"})]})]}),e.jsxs("div",{className:"p-4 bg-stone-50 rounded-xl",children:[e.jsx("label",{className:"text-xs font-bold text-stone-500 mb-1 block",children:"èª¬æ˜æ–‡"}),e.jsx("p",{className:"text-sm text-stone-600 whitespace-pre-wrap",children:o.quest.description||"ï¼ˆæœªè¨­å®šï¼‰"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"p-4 bg-stone-50 rounded-xl",children:[e.jsx("label",{className:"text-xs font-bold text-stone-500 mb-1 block",children:"é›£æ˜“åº¦"}),e.jsx("p",{className:"text-sm",children:o.quest.difficulty||"ï¼ˆæœªè¨­å®šï¼‰"})]}),e.jsxs("div",{className:"p-4 bg-stone-50 rounded-xl",children:[e.jsx("label",{className:"text-xs font-bold text-stone-500 mb-1 block",children:"ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ"}),e.jsx("p",{className:"text-sm",children:o.quest.target_audience||"ï¼ˆæœªè¨­å®šï¼‰"})]})]})]}):e.jsx("p",{className:"text-sm text-stone-400 italic",children:"ç¿»è¨³ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ç¿»è¨³ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚"})})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>I("story"),className:"w-full flex items-center justify-between px-6 py-4 hover:bg-stone-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{size:18,className:"text-brand-gold"}),e.jsx("span",{className:"font-bold text-brand-dark",children:"ã‚¹ãƒˆãƒ¼ãƒªãƒ¼"})]}),g.story?e.jsx(z,{size:20}):e.jsx(q,{size:20})]}),g.story&&e.jsx("div",{className:"px-6 pb-6 space-y-4",children:(l==="ja"?a:o.story)?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-amber-50 rounded-xl border border-amber-100",children:[e.jsx("label",{className:"text-xs font-bold text-amber-700 mb-1 block",children:"ğŸ­ æ¡ˆå†…äººï¼ˆã‚­ãƒ£ã‚¹ãƒˆï¼‰"}),e.jsx("p",{className:"text-sm font-bold",children:((K=l==="ja"?a:o.story)==null?void 0:K.cast_name)||"ï¼ˆæœªè¨­å®šï¼‰"}),((R=l==="ja"?a:o.story)==null?void 0:R.cast_tone)&&e.jsxs("p",{className:"text-xs text-stone-500 mt-1",children:["å£èª¿: ",(V=l==="ja"?a:o.story)==null?void 0:V.cast_tone]})]}),e.jsxs("div",{className:"p-4 bg-indigo-50 rounded-xl border border-indigo-100",children:[e.jsx("label",{className:"text-xs font-bold text-indigo-700 mb-2 block",children:"ğŸ¬ ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°"}),((Y=l==="ja"?a:o.story)==null?void 0:Y.prologue_title)&&e.jsx("p",{className:"text-sm font-bold mb-2",children:(H=l==="ja"?a:o.story)==null?void 0:H.prologue_title}),e.jsx("p",{className:"text-sm text-stone-600 whitespace-pre-wrap",children:((W=l==="ja"?a:o.story)==null?void 0:W.prologue)||"ï¼ˆæœªè¨­å®šï¼‰"})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-xl border border-purple-100",children:[e.jsx("label",{className:"text-xs font-bold text-purple-700 mb-2 block",children:"ğŸŒŸ ã‚¨ãƒ”ãƒ­ãƒ¼ã‚°"}),e.jsx("p",{className:"text-sm text-stone-600 whitespace-pre-wrap",children:((X=l==="ja"?a:o.story)==null?void 0:X.epilogue)||"ï¼ˆæœªè¨­å®šï¼‰"})]})]}):e.jsx("p",{className:"text-sm text-stone-400 italic",children:l==="ja"?"ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚":"ç¿»è¨³ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ç¿»è¨³ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚"})})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>I("characters"),className:"w-full flex items-center justify-between px-6 py-4 hover:bg-stone-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{size:18,className:"text-brand-gold"}),e.jsxs("span",{className:"font-bold text-brand-dark",children:["ç™»å ´äººç‰© (",(l==="ja"?_:o.characters).length,"å)"]})]}),g.characters?e.jsx(z,{size:20}):e.jsx(q,{size:20})]}),g.characters&&e.jsx("div",{className:"px-6 pb-6",children:(l==="ja"?_:o.characters).length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(l==="ja"?_:o.characters).map((s,t)=>e.jsxs("div",{className:"p-4 bg-stone-50 rounded-xl",children:[e.jsx("p",{className:"font-bold text-brand-dark",children:s.name||"åå‰æœªè¨­å®š"}),s.role&&e.jsx("p",{className:"text-xs text-stone-500",children:s.role}),s.tone&&e.jsxs("p",{className:"text-xs text-amber-600 mt-1",children:["å£èª¿: ",s.tone]}),s.description&&e.jsx("p",{className:"text-sm text-stone-600 mt-2",children:s.description})]},s.id||t))}):e.jsx("p",{className:"text-sm text-stone-400 italic",children:"ç™»å ´äººç‰©ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"})})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>I("spots"),className:"w-full flex items-center justify-between px-6 py-4 hover:bg-stone-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{size:18,className:"text-brand-gold"}),e.jsxs("span",{className:"font-bold text-brand-dark",children:["ã‚¹ãƒãƒƒãƒˆ (",(l==="ja"?f:o.spots).length,"ä»¶)"]})]}),g.spots?e.jsx(z,{size:20}):e.jsx(q,{size:20})]}),g.spots&&e.jsx("div",{className:"px-6 pb-6 space-y-3",children:(l==="ja"?f:o.spots).length>0?(l==="ja"?f:o.spots).map((s,t)=>e.jsxs("div",{className:"border border-stone-200 rounded-xl overflow-hidden",children:[e.jsxs("button",{onClick:()=>he(s.id),className:"w-full flex items-center justify-between px-4 py-3 bg-stone-50 hover:bg-stone-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-7 h-7 rounded-full bg-brand-gold text-white text-sm font-bold flex items-center justify-center",children:t+1}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"font-bold text-brand-dark",children:s.name||"ï¼ˆæœªè¨­å®šï¼‰"}),e.jsx("p",{className:"text-xs text-stone-500",children:s.address})]})]}),P[s.id]?e.jsx(z,{size:18}):e.jsx(q,{size:18})]}),P[s.id]&&e.jsxs("div",{className:"p-4 space-y-3 bg-white",children:[s.directions&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-stone-500 mb-1 block",children:"ğŸ“ é“æ¡ˆå†…"}),e.jsx("p",{className:"text-sm text-stone-600",children:s.directions})]}),s.story_intro&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-stone-500 mb-1 block",children:"ğŸ“– ã‚¹ãƒˆãƒ¼ãƒªãƒ¼å°å…¥"}),e.jsx("p",{className:"text-sm text-stone-600",children:s.story_intro})]}),s.challenge_text&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-stone-500 mb-1 block",children:"ğŸ§© è¬ãƒ»ãƒãƒ£ãƒ¬ãƒ³ã‚¸"}),e.jsx("p",{className:"text-sm text-stone-600",children:s.challenge_text})]}),s.hints&&s.hints.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-stone-500 mb-1 block",children:"ğŸ’¡ ãƒ’ãƒ³ãƒˆ"}),e.jsx("ul",{className:"text-sm text-stone-600 list-disc list-inside",children:s.hints.map((d,i)=>e.jsx("li",{children:d},i))})]}),s.answer&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-stone-500 mb-1 block",children:"âœ… æ­£è§£"}),e.jsx("p",{className:"text-sm text-stone-600 font-mono bg-stone-100 px-2 py-1 rounded",children:s.answer})]}),s.success_message&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-stone-500 mb-1 block",children:"ğŸ‰ æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"}),e.jsx("p",{className:"text-sm text-stone-600",children:s.success_message})]})]})]},s.id||t)):e.jsx("p",{className:"text-sm text-stone-400 italic",children:l==="ja"?"ã‚¹ãƒãƒƒãƒˆãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚":"ç¿»è¨³ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚ç¿»è¨³ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚"})})]}),e.jsxs("div",{children:[e.jsxs("button",{onClick:()=>I("conversations"),className:"w-full flex items-center justify-between px-6 py-4 hover:bg-stone-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{size:18,className:"text-brand-gold"}),e.jsx("span",{className:"font-bold text-brand-dark",children:"ã‚¹ãƒãƒƒãƒˆä¼šè©±"}),e.jsx("span",{className:`ml-2 px-2 py-0.5 text-xs rounded-full ${y.length>0?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:y.length>0?`${y.length}ä»¶`:"æœªç”Ÿæˆ"})]}),g.conversations?e.jsx(z,{size:20}):e.jsx(q,{size:20})]}),g.conversations&&e.jsx("div",{className:"px-6 pb-6 space-y-4",children:y.length>0?f.map((s,t)=>{const d=y.filter(n=>n.spot_id===s.id&&n.message_type==="pre_puzzle"),i=y.filter(n=>n.spot_id===s.id&&n.message_type==="post_puzzle");return d.length===0&&i.length===0?null:e.jsxs("div",{className:"border border-stone-200 rounded-xl overflow-hidden",children:[e.jsx("div",{className:"px-4 py-3 bg-stone-50 border-b border-stone-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-7 h-7 rounded-full bg-brand-gold text-white text-sm font-bold flex items-center justify-center",children:t+1}),e.jsx("p",{className:"font-bold text-brand-dark",children:s.name})]})}),e.jsxs("div",{className:"p-4 space-y-4",children:[d.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-indigo-600 mb-2 block",children:"ğŸ¬ è¬è§£ãå‰ã®ä¼šè©±"}),e.jsx("div",{className:"space-y-2",children:d.map((n,p)=>e.jsxs("div",{className:`p-3 rounded-lg ${n.speaker_type==="narrator"?"bg-stone-100 italic":"bg-indigo-50"}`,children:[e.jsx("p",{className:"text-xs font-bold text-stone-500 mb-1",children:n.speaker_name}),e.jsx("p",{className:"text-sm text-stone-700",children:n.message_text})]},p))})]}),i.length>0&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-green-600 mb-2 block",children:"ğŸ‰ è¬è§£ãå¾Œã®ä¼šè©±"}),e.jsx("div",{className:"space-y-2",children:i.map((n,p)=>e.jsxs("div",{className:`p-3 rounded-lg ${n.speaker_type==="narrator"?"bg-stone-100 italic":"bg-green-50"}`,children:[e.jsx("p",{className:"text-xs font-bold text-stone-500 mb-1",children:n.speaker_name}),e.jsx("p",{className:"text-sm text-stone-700",children:n.message_text})]},p))})]})]})]},s.id)}):e.jsxs("div",{className:"p-6 text-center bg-stone-50 rounded-xl",children:[e.jsx(se,{size:32,className:"mx-auto text-stone-300 mb-3"}),e.jsx("p",{className:"text-sm text-stone-500",children:"ã‚¹ãƒãƒƒãƒˆä¼šè©±ãŒã¾ã ç”Ÿæˆã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚"}),e.jsx("p",{className:"text-xs text-stone-400 mt-1",children:"AI Assistantã§ã‚¯ã‚¨ã‚¹ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã¨ã€å„ã‚¹ãƒãƒƒãƒˆã®ä¼šè©±ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚"})]})})]})]})]}),b.length>0&&e.jsxs("div",{className:"mt-8 text-center",children:[e.jsx("button",{className:`px-8 py-4 bg-gradient-to-r from-indigo-500 to-purple-600 text-white font-bold rounded-xl shadow-lg hover:shadow-xl transition-all flex items-center justify-center gap-2 mx-auto ${E?"opacity-75 cursor-not-allowed":""}`,onClick:be,disabled:E,children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"ç¿»è¨³ç”Ÿæˆä¸­..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ye,{size:20}),"é¸æŠã—ãŸè¨€èªã§ç¿»è¨³ã‚’ç”Ÿæˆ"]})}),e.jsx("p",{className:"text-xs text-stone-500 mt-2",children:"AIç¿»è¨³ã‚’ä½¿ç”¨ã—ã¦ã€é¸æŠã—ãŸè¨€èªã®ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™"}),U&&e.jsxs("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-700",children:["âŒ ",U]}),me&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-xl text-sm text-green-700",children:"âœ… ç¿»è¨³ã®ç”ŸæˆãŒå®Œäº†ã—ã¾ã—ãŸï¼ã‚¿ãƒ–ã‚’åˆ‡ã‚Šæ›¿ãˆã¦ç¢ºèªã—ã¦ãã ã•ã„ã€‚"})]}),e.jsxs("div",{className:"mt-8 flex gap-4 justify-center",children:[e.jsx("button",{onClick:()=>{v&&localStorage.setItem(`step-status:${v}:4`,"in_progress"),$("/creator/workspace")},className:"px-8 py-3 rounded-xl border-2 border-brand-gold bg-white text-brand-gold font-bold text-sm hover:bg-brand-gold/5 transition-all",children:"ä¸€æ™‚ä¿å­˜ã™ã‚‹"}),e.jsx("button",{onClick:()=>{v&&localStorage.setItem(`step-status:${v}:4`,"completed"),$("/creator/workspace")},disabled:b.length===0,title:b.length===0?"è¨€èªã‚’é¸æŠã—ã¦ãã ã•ã„":"",className:`px-8 py-3 rounded-xl font-bold text-sm transition-all ${b.length>0?"bg-brand-dark text-white hover:bg-brand-gold hover:shadow-lg hover:-translate-y-0.5":"bg-stone-200 text-stone-400 cursor-not-allowed"}`,children:"å®Œäº†ã™ã‚‹"})]})]})]})}export{Te as default};
