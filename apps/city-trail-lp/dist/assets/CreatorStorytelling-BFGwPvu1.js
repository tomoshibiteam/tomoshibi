import{u as xe,r as d,j as e,s as j}from"./index-VJX5zWq_.js";import{T as pe}from"./TomoshibiLogo-BVN6SfG2.js";import{B as me,U as he,M as ge}from"./users-DCMXpzDX.js";import{M as ee}from"./message-circle-DxUchsAL.js";import{S as A,a as be,P as te,W as ue}from"./wand-sparkles-D8zMdiHu.js";import{C as fe}from"./circle-check-big-DNq-ELMc.js";import{G as je,T as ve}from"./trash-2-CyB3FX1s.js";import{c as Ne}from"./createLucideIcon-Dxvw1eg7.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],we=Ne("pen",ye),U=[{id:"c1",name:"æ¡ˆå†…äºº",role:"ã‚¬ã‚¤ãƒ‰",color:"bg-brand-gold"},{id:"c2",name:"è¬ã®å£°",role:"èªã‚Šæ‰‹",color:"bg-indigo-500"}],se=y=>`https://api.dicebear.com/7.x/bottts-neutral/svg?seed=${encodeURIComponent(y)}&radius=50&backgroundColor=b6e3f4,c0aede,d1d4f9`;function Ee(){var Q,W,H,V,J,K,X,Y;const y=xe(),[re,M]=d.useState(!0),[v,L]=d.useState(!1),[g,P]=d.useState(""),[b,G]=d.useState(""),[p,N]=d.useState([]),[c,z]=d.useState("prologue"),[S,ae]=d.useState(null),[n,oe]=d.useState([]),[i,D]=d.useState(null),[l,w]=d.useState({}),[u,F]=d.useState("pre"),[ne,I]=d.useState(!1),[O,R]=d.useState(!1),[T,_]=d.useState([]),[$,le]=d.useState(null),[ie,de]=d.useState("");d.useEffect(()=>{(async()=>{const r=localStorage.getItem("quest-id");if(!r){M(!1);return}ae(r);try{const{data:s}=await j.from("story_timelines").select("prologue, epilogue, characters, cast_name, cast_tone").eq("quest_id",r).single();s?(P(s.prologue||""),G(s.epilogue||""),Array.isArray(s.characters)&&s.characters.length>0?N(s.characters):s.cast_name?N([{id:"c1",name:s.cast_name,role:s.cast_tone||"Navigator",color:"bg-brand-gold"}]):N(U)):N(U);const{data:a}=await j.from("spots").select("id, name, order_index").eq("quest_id",r).order("order_index",{ascending:!0});if(a&&a.length>0){const h=a.map(o=>o.id),{data:m}=await j.from("spot_details").select("spot_id, puzzle_text, answer").in("spot_id",h),x={};m==null||m.forEach(o=>{x[o.spot_id]={puzzleText:o.puzzle_text,answer:o.answer}});const f=a.map(o=>{var C,Z;return{id:o.id,name:o.name||`ã‚¹ãƒãƒƒãƒˆ ${o.order_index}`,orderIndex:o.order_index,puzzleText:(C=x[o.id])==null?void 0:C.puzzleText,answer:(Z=x[o.id])==null?void 0:Z.answer}});oe(f),f.length>0&&D(f[0].id);const{data:q}=await j.from("spot_story_messages").select("id, spot_id, stage, order_index, speaker_type, speaker_name, avatar_url, text").in("spot_id",h).order("order_index",{ascending:!0}),k={};f.forEach(o=>{k[o.id]={pre:[],post:[]}}),q==null||q.forEach(o=>{const C={id:o.id,speakerType:o.speaker_type||"narrator",speakerName:o.speaker_name||"",avatarUrl:o.avatar_url,text:o.text||""};k[o.spot_id]&&(o.stage==="pre_puzzle"?k[o.spot_id].pre.push(C):o.stage==="post_puzzle"&&k[o.spot_id].post.push(C))}),w(k)}}catch(s){console.error("Load failed:",s),N(U)}finally{M(!1)}})()},[]);const E=async(t,r=!1)=>{if(!S){alert("ã‚¯ã‚¨ã‚¹ãƒˆIDãŒã‚ã‚Šã¾ã›ã‚“ã€‚ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã‹ã‚‰é–‹ã„ã¦ãã ã•ã„ã€‚");return}L(!0);try{if(await j.from("story_timelines").upsert({quest_id:S,prologue:g,epilogue:b,characters:p},{onConflict:"quest_id"}),n.length>0){const s=n.map(h=>h.id);await j.from("spot_story_messages").delete().in("spot_id",s);const a=[];for(const h of s){const m=l[h];m&&(m.pre.forEach((x,f)=>{a.push({spot_id:h,stage:"pre_puzzle",order_index:f,speaker_type:x.speakerType,speaker_name:x.speakerName,avatar_url:x.avatarUrl,text:x.text})}),m.post.forEach((x,f)=>{a.push({spot_id:h,stage:"post_puzzle",order_index:f,speaker_type:x.speakerType,speaker_name:x.speakerName,avatar_url:x.avatarUrl,text:x.text})}))}a.length>0&&await j.from("spot_story_messages").insert(a)}localStorage.setItem(`step-status:${S}:3`,t),r&&y("/creator/workspace")}catch(s){console.error("Save failed:",s)}finally{L(!1)}};if(re)return e.jsx("section",{className:"min-h-screen bg-stone-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-brand-gold border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-stone-500",children:"èª­ã¿è¾¼ã¿ä¸­..."})]})});const B=async t=>{var r,s;le(t.id),de(t.name),_([]),I(!0),R(!0);try{const a=await j.functions.invoke("generate-character-icon",{body:{questId:S||"temp",characterId:t.id,name:t.name,role:t.role,artStyle:"anime style"}});if(a.error)throw a.error;(s=(r=a.data)==null?void 0:r.imageUrls)!=null&&s.length?_(a.data.imageUrls):_([se(t.name)])}catch(a){console.error("Icon generation failed:",a),_([se(t.name)]),alert("ã‚¢ã‚¤ã‚³ãƒ³ç”Ÿæˆã«å¤±æ•—ã—ãŸãŸã‚ã€ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’ææ¡ˆã—ã¾ã—ãŸã€‚")}finally{R(!1)}},ce=t=>{if(!$)return;const r=p.map(s=>s.id===$?{...s,icon:t}:s);N(r),I(!1),_([])};return e.jsxs("section",{className:"min-h-screen bg-stone-50 flex flex-col relative",children:[e.jsx("div",{className:"bg-white/80 backdrop-blur-md border-b border-stone-200 sticky top-0 z-50",children:e.jsxs("div",{className:"container mx-auto px-4 md:px-8 py-3 flex items-center justify-between",children:[e.jsx("button",{onClick:()=>y("/"),className:"hover:opacity-80 transition-opacity",children:e.jsx(pe,{className:"h-7 w-auto"})}),e.jsxs("div",{className:"flex items-center gap-4 text-xs font-bold text-stone-400",children:[e.jsx("span",{className:"hidden md:inline",children:"Step 1: åŸºæœ¬æƒ…å ±"}),e.jsx("span",{children:"â€º"}),e.jsx("span",{className:"hidden md:inline",children:"Step 2: ã‚¹ãƒãƒƒãƒˆ"}),e.jsx("span",{children:"â€º"}),e.jsx("span",{className:"text-brand-dark px-2 py-1 bg-brand-gold/10 rounded",children:"Step 3: ã‚¹ãƒˆãƒ¼ãƒªãƒ¼"}),e.jsx("span",{children:"â€º"}),e.jsx("span",{children:"Step 4: ãƒ†ã‚¹ãƒˆ"})]})]})}),e.jsxs("div",{className:"flex-1 container mx-auto px-4 md:px-8 py-8 max-w-5xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("button",{onClick:()=>y("/creator/workspace"),className:"text-xs font-bold text-stone-500 hover:text-brand-dark flex items-center gap-1 transition-colors",children:[e.jsx("span",{className:"text-lg",children:"â€¹"})," ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã«æˆ»ã‚‹"]}),e.jsx("h1",{className:"text-3xl font-serif font-bold text-brand-dark",children:"ã‚¹ãƒˆãƒ¼ãƒªãƒ¼è¨­å®š"})]}),e.jsxs("div",{className:"grid lg:grid-cols-12 gap-8 h-[calc(100vh-200px)]",children:[e.jsxs("div",{className:"lg:col-span-4 flex flex-col gap-6",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-stone-200 p-2 shadow-sm",children:[e.jsxs("button",{onClick:()=>z("prologue"),className:`w-full text-left px-4 py-3 rounded-xl text-sm font-bold flex items-center gap-3 transition-colors ${c==="prologue"?"bg-indigo-50 text-indigo-700":"text-stone-600 hover:bg-stone-50"}`,children:[e.jsx(me,{size:18}),"ãƒ—ãƒ­ãƒ­ãƒ¼ã‚° ",e.jsx("span",{className:"text-xs font-normal text-stone-400 ml-auto",children:"å°å…¥"})]}),e.jsxs("button",{onClick:()=>z("spots"),className:`w-full text-left px-4 py-3 rounded-xl text-sm font-bold flex items-center gap-3 transition-colors ${c==="spots"?"bg-emerald-50 text-emerald-700":"text-stone-600 hover:bg-stone-50"}`,children:[e.jsx(ee,{size:18}),"ã‚¹ãƒãƒƒãƒˆä¼šè©±",n.length>0&&e.jsxs("span",{className:"text-xs font-normal text-stone-400 ml-auto",children:[n.length,"ä»¶"]})]}),e.jsxs("button",{onClick:()=>z("epilogue"),className:`w-full text-left px-4 py-3 rounded-xl text-sm font-bold flex items-center gap-3 transition-colors ${c==="epilogue"?"bg-indigo-50 text-indigo-700":"text-stone-600 hover:bg-stone-50"}`,children:[e.jsx(A,{size:18}),"ã‚¨ãƒ”ãƒ­ãƒ¼ã‚° ",e.jsx("span",{className:"text-xs font-normal text-stone-400 ml-auto",children:"ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°"})]}),e.jsxs("button",{onClick:()=>z("cast"),className:`w-full text-left px-4 py-3 rounded-xl text-sm font-bold flex items-center gap-3 transition-colors ${c==="cast"?"bg-indigo-50 text-indigo-700":"text-stone-600 hover:bg-stone-50"}`,children:[e.jsx(he,{size:18}),"ç™»å ´äººç‰©"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-brand-base/30 to-white rounded-2xl border border-brand-gold/20 p-6",children:[e.jsxs("h3",{className:"text-sm font-bold text-brand-dark mb-2 flex items-center gap-2",children:[e.jsx(A,{size:14,className:"text-brand-gold"})," ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã®ã‚³ãƒ„"]}),e.jsx("p",{className:"text-xs text-stone-600 leading-relaxed",children:c==="spots"?"å„ã‚¹ãƒãƒƒãƒˆã§ã€Œåˆ°ç€å¾Œâ†’è¬â†’è§£æ±ºå¾Œã€ã®è‡ªç„¶ãªæµã‚Œã‚’ä½œã‚Šã¾ã—ã‚‡ã†ã€‚å‰å¾Œã®æ–‡è„ˆã‚’ç¢ºèªã—ãªãŒã‚‰ä¼šè©±ã‚’æ›¸ãã¨ç¹‹ãŒã‚ŠãŒè‰¯ããªã‚Šã¾ã™ã€‚":"é­…åŠ›çš„ãªã‚¯ã‚¨ã‚¹ãƒˆã«ã¯å¼•ãè¾¼ã¾ã‚Œã‚‹ç‰©èªãŒå¿…è¦ã§ã™ã€‚ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ã§æœŸå¾…æ„Ÿã‚’é«˜ã‚ã€ã‚¨ãƒ”ãƒ­ãƒ¼ã‚°ã§ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®é”æˆæ„Ÿã‚’æ¼”å‡ºã—ã¾ã—ã‚‡ã†ã€‚"})]})]}),e.jsxs("div",{className:"lg:col-span-8 bg-white rounded-3xl border border-stone-200 shadow-xl flex flex-col overflow-hidden relative",children:[e.jsxs("div",{className:"border-b border-stone-100 p-4 flex justify-between items-center bg-stone-50/50",children:[e.jsx("span",{className:"text-xs font-bold text-stone-400 uppercase tracking-wider",children:c==="prologue"?"ã‚ªãƒ¼ãƒ—ãƒ‹ãƒ³ã‚°":c==="epilogue"?"ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°":c==="spots"?"ã‚¹ãƒãƒƒãƒˆä¼šè©±ç·¨é›†":"ç™»å ´äººç‰©ç®¡ç†"}),e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>E("in_progress",!1),disabled:v,className:"px-4 py-1.5 rounded-full bg-brand-dark text-white text-xs font-bold hover:bg-brand-gold transition-colors flex items-center gap-2",children:v?"ä¿å­˜ä¸­...":e.jsxs(e.Fragment,{children:[e.jsx(be,{size:14})," ä¿å­˜"]})})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8 custom-scrollbar",children:c==="prologue"||c==="epilogue"?e.jsxs("div",{className:"space-y-4 h-full flex flex-col",children:[e.jsx("textarea",{value:c==="prologue"?g:b,onChange:t=>c==="prologue"?P(t.target.value):G(t.target.value),className:"w-full flex-1 resize-none focus:outline-none text-lg leading-relaxed text-stone-700 placeholder:text-stone-300",placeholder:c==="prologue"?"ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...":"ã‚¨ãƒ”ãƒ­ãƒ¼ã‚°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."}),e.jsxs("div",{className:"text-right text-xs text-stone-400",children:[(c==="prologue"?g:b).length," æ–‡å­—"]})]}):c==="spots"?e.jsxs("div",{className:"flex gap-6 h-full",children:[e.jsxs("div",{className:"w-48 flex-shrink-0 space-y-2",children:[e.jsx("h4",{className:"text-xs font-bold text-stone-400 uppercase tracking-wider mb-3",children:"ã‚¹ãƒãƒƒãƒˆä¸€è¦§"}),n.map((t,r)=>e.jsxs("button",{onClick:()=>D(t.id),className:`w-full text-left px-3 py-2 rounded-lg text-sm flex items-center gap-2 transition-colors ${i===t.id?"bg-emerald-100 text-emerald-800 font-bold":"text-stone-600 hover:bg-stone-100"}`,children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-stone-200 flex items-center justify-center text-xs font-bold",children:r+1}),e.jsx("span",{className:"truncate",children:t.name}),l[t.id]&&(l[t.id].pre.length>0||l[t.id].post.length>0)&&e.jsx(fe,{size:12,className:"ml-auto text-emerald-500"})]},t.id))]}),e.jsx("div",{className:"flex-1 flex flex-col",children:i&&n.find(t=>t.id===i)?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("button",{onClick:()=>F("pre"),className:`px-4 py-2 rounded-lg text-sm font-bold transition-colors ${u==="pre"?"bg-emerald-100 text-emerald-800":"bg-stone-100 text-stone-600 hover:bg-stone-200"}`,children:["ã‚¹ãƒãƒƒãƒˆå‰ä¼šè©±",e.jsxs("span",{className:"ml-1 text-xs opacity-70",children:["(",((Q=l[i])==null?void 0:Q.pre.length)||0,")"]})]}),e.jsxs("button",{onClick:()=>F("post"),className:`px-4 py-2 rounded-lg text-sm font-bold transition-colors ${u==="post"?"bg-emerald-100 text-emerald-800":"bg-stone-100 text-stone-600 hover:bg-stone-200"}`,children:["ã‚¹ãƒãƒƒãƒˆå¾Œä¼šè©±",e.jsxs("span",{className:"ml-1 text-xs opacity-70",children:["(",((W=l[i])==null?void 0:W.post.length)||0,")"]})]})]}),e.jsxs("div",{className:"mb-4 p-3 bg-stone-50 rounded-lg border border-stone-200",children:[e.jsx("div",{className:"text-xs text-stone-500 mb-1",children:"ç¾åœ¨ã®è¬:"}),e.jsx("div",{className:"text-sm text-stone-700",children:((H=n.find(t=>t.id===i))==null?void 0:H.puzzleText)||"ï¼ˆæœªè¨­å®šï¼‰"})]}),e.jsxs("div",{className:"flex-1 space-y-3 overflow-y-auto",children:[(K=u==="pre"?(V=l[i])==null?void 0:V.pre:(J=l[i])==null?void 0:J.post)==null?void 0:K.map((t,r)=>e.jsxs("div",{className:"flex gap-3 items-start p-3 bg-white rounded-lg border border-stone-200 group",children:[e.jsx("div",{className:"w-6 text-stone-300 cursor-grab",children:e.jsx(je,{size:16})}),e.jsxs("select",{value:t.speakerType==="narrator"?"__narrator__":t.speakerName,onChange:s=>{const a={...l},m=(u==="pre"?a[i].pre:a[i].post)[r];s.target.value==="__narrator__"?(m.speakerType="narrator",m.speakerName="ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"):(m.speakerType="character",m.speakerName=s.target.value),w(a)},className:"w-28 text-xs border border-stone-200 rounded px-2 py-1 bg-white",children:[e.jsx("option",{value:"__narrator__",children:"ãƒŠãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³"}),p.map(s=>e.jsx("option",{value:s.name,children:s.name},s.id))]}),e.jsx("textarea",{value:t.text,onChange:s=>{const a={...l},h=u==="pre"?a[i].pre:a[i].post;h[r].text=s.target.value,w(a)},className:"flex-1 text-sm resize-none border-0 bg-transparent focus:outline-none",rows:2,placeholder:"ã‚»ãƒªãƒ•ã‚’å…¥åŠ›..."}),e.jsx("button",{onClick:()=>{const s={...l};(u==="pre"?s[i].pre:s[i].post).splice(r,1),w(s)},className:"text-stone-300 hover:text-rose-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(ve,{size:14})})]},t.id)),(((Y=(X=l[i])==null?void 0:X[u])==null?void 0:Y.length)||0)===0&&e.jsxs("div",{className:"text-center py-8 text-stone-400",children:[e.jsx(ee,{size:32,className:"mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"ã¾ã ä¼šè©±ãŒã‚ã‚Šã¾ã›ã‚“"})]})]}),e.jsx("div",{className:"flex gap-2 mt-4 pt-4 border-t border-stone-100",children:e.jsxs("button",{onClick:()=>{var s;const t={...l},r={id:`new-${Date.now()}`,speakerType:"character",speakerName:((s=p[0])==null?void 0:s.name)||"æ¡ˆå†…äºº",text:""};u==="pre"?t[i].pre.push(r):t[i].post.push(r),w(t)},className:"flex items-center gap-2 px-4 py-2 text-sm font-bold text-emerald-700 bg-emerald-50 rounded-lg hover:bg-emerald-100 transition-colors",children:[e.jsx(te,{size:16})," ã‚»ãƒªãƒ•è¿½åŠ "]})})]}):e.jsx("div",{className:"flex items-center justify-center h-full text-stone-400",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ge,{size:48,className:"mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"å·¦ã‹ã‚‰ã‚¹ãƒãƒƒãƒˆã‚’é¸æŠã—ã¦ãã ã•ã„"})]})})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-brand-dark",children:"ç™»å ´äººç‰©ä¸€è¦§"}),e.jsxs("button",{className:"text-xs font-bold text-brand-gold hover:underline flex items-center gap-1",children:[e.jsx(te,{size:14})," è¿½åŠ "]})]}),e.jsx("div",{className:"grid gap-4",children:p.map((t,r)=>e.jsxs("div",{className:"p-4 rounded-xl border border-stone-200 bg-stone-50 hover:bg-white transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[t.icon?e.jsx("img",{src:t.icon,alt:t.name,className:"w-12 h-12 rounded-full object-cover border-2 border-stone-200"}):e.jsx("div",{className:`w-12 h-12 rounded-full ${t.color} flex items-center justify-center text-white font-bold text-lg`,children:t.name[0]}),!t.icon&&e.jsx("div",{className:"absolute -bottom-1 -right-1 w-5 h-5 bg-amber-100 border border-amber-300 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-[10px]",children:"âš ï¸"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-stone-800",children:t.name}),e.jsx("p",{className:"text-xs text-stone-500",children:t.role})]}),e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsxs("button",{className:"text-xs text-indigo-600 hover:text-indigo-800 flex items-center gap-1 px-2 py-1 bg-indigo-50 rounded shadow-sm border border-indigo-100",onClick:s=>{s.stopPropagation(),B(t)},children:[e.jsx(ue,{size:12})," AIç”Ÿæˆ"]}),e.jsx("button",{className:"text-stone-400 hover:text-stone-600 p-1",children:e.jsx(we,{size:16})})]})]}),!t.icon&&e.jsx("div",{className:"mt-3 p-2 bg-amber-50 border border-amber-200 rounded-lg text-xs text-amber-700",children:"ğŸ“· ã‚¢ã‚¤ã‚³ãƒ³æœªè¨­å®š - AIç”Ÿæˆã¾ãŸã¯ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§è¿½åŠ ã—ã¦ãã ã•ã„"})]},t.id))})]})}),e.jsxs("div",{className:"border-t border-stone-100 p-3 bg-stone-50/50",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-3 px-2 py-1.5 bg-white rounded-lg border border-stone-200 mb-3",children:[e.jsx("span",{className:"text-[10px] font-bold text-stone-400 uppercase",children:"å®Œäº†æ¡ä»¶"}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center text-[10px] ${g.trim()?"bg-emerald-500 text-white":"border border-rose-400 text-rose-400"}`,children:g.trim()?"âœ“":"!"}),e.jsxs("span",{className:`text-xs ${g.trim()?"text-emerald-700":"text-rose-600"}`,children:["ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°",e.jsx("span",{className:"text-[10px] ml-0.5",children:"(å¿…é ˆ)"})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center text-[10px] ${b.trim()?"bg-emerald-500 text-white":"border border-rose-400 text-rose-400"}`,children:b.trim()?"âœ“":"!"}),e.jsxs("span",{className:`text-xs ${b.trim()?"text-emerald-700":"text-rose-600"}`,children:["ã‚¨ãƒ”ãƒ­ãƒ¼ã‚°",e.jsx("span",{className:"text-[10px] ml-0.5",children:"(å¿…é ˆ)"})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center text-[10px] ${p.length>=1?"bg-emerald-500 text-white":"border border-rose-400 text-rose-400"}`,children:p.length>=1?"âœ“":"!"}),e.jsxs("span",{className:`text-xs ${p.length>=1?"text-emerald-700":"text-rose-600"}`,children:["ç™»å ´äººç‰©",e.jsx("span",{className:"text-[10px] ml-0.5",children:"(1äººä»¥ä¸Šå¿…é ˆ)"})]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center text-[10px] ${n.length>0&&n.every(t=>{var r,s;return(((s=(r=l[t.id])==null?void 0:r.pre)==null?void 0:s.length)||0)>0})?"bg-emerald-500 text-white":"border border-rose-400 text-rose-400"}`,children:n.length>0&&n.every(t=>{var r,s;return(((s=(r=l[t.id])==null?void 0:r.pre)==null?void 0:s.length)||0)>0})?"âœ“":"!"}),e.jsxs("span",{className:`text-xs ${n.length>0&&n.every(t=>{var r,s;return(((s=(r=l[t.id])==null?void 0:r.pre)==null?void 0:s.length)||0)>0})?"text-emerald-700":"text-rose-600"}`,children:["ã‚¹ãƒãƒƒãƒˆä¼šè©±",e.jsx("span",{className:"text-[10px] ml-0.5",children:"(å¿…é ˆ)"})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>E("in_progress",!0),disabled:v,className:"flex-1 py-2.5 rounded-lg border-2 border-brand-gold bg-white text-brand-gold font-bold text-sm hover:bg-brand-gold/5 transition-all disabled:opacity-50",children:v?"ä¿å­˜ä¸­...":"ä¸€æ™‚ä¿å­˜ã™ã‚‹"}),e.jsx("button",{onClick:()=>E("completed",!0),disabled:v||!g.trim()||!b.trim()||p.length<1||n.length===0||!n.every(t=>{var r,s;return(((s=(r=l[t.id])==null?void 0:r.pre)==null?void 0:s.length)||0)>0}),title:g.trim()?b.trim()?p.length<1?"ç™»å ´äººç‰©ã‚’1äººä»¥ä¸Šè¿½åŠ ã—ã¦ãã ã•ã„":n.length===0||!n.every(t=>{var r,s;return(((s=(r=l[t.id])==null?void 0:r.pre)==null?void 0:s.length)||0)>0})?"å…¨ã‚¹ãƒãƒƒãƒˆã®ã‚¹ãƒãƒƒãƒˆå‰ä¼šè©±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„":"":"ã‚¨ãƒ”ãƒ­ãƒ¼ã‚°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„":"ãƒ—ãƒ­ãƒ­ãƒ¼ã‚°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„",className:`flex-1 py-2.5 rounded-lg font-bold text-sm transition-all disabled:opacity-50 ${g.trim()&&b.trim()&&p.length>=1&&n.length>0&&n.every(t=>{var r,s;return(((s=(r=l[t.id])==null?void 0:r.pre)==null?void 0:s.length)||0)>0})?"bg-brand-dark text-white hover:bg-brand-gold hover:shadow-lg":"bg-stone-200 text-stone-400 cursor-not-allowed"}`,children:v?"ä¿å­˜ä¸­...":"å®Œäº†ã™ã‚‹"})]})]})]})]})]}),ne&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-2xl overflow-hidden shadow-2xl animate-in fade-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"p-6 border-b border-stone-100 bg-stone-50 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-brand-dark",children:["ã‚¢ã‚¤ã‚³ãƒ³ç”Ÿæˆ: ",ie]}),e.jsx("p",{className:"text-xs text-stone-500",children:"ã‚­ãƒ£ãƒ©ã‚¯ã‚¿ãƒ¼è¨­å®šã‹ã‚‰æœ€é©ãªã‚¢ã‚¤ã‚³ãƒ³ã‚’AIãŒææ¡ˆã—ã¾ã™"})]}),e.jsx("button",{onClick:()=>I(!1),className:"text-stone-400 hover:text-stone-600",children:"Ã—"})]}),e.jsx("div",{className:"p-8",children:O?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-indigo-500 border-t-transparent rounded-full animate-spin mx-auto mb-6"}),e.jsx("h4",{className:"text-lg font-bold text-indigo-900 mb-2",children:"ç”Ÿæˆä¸­..."}),e.jsxs("p",{className:"text-sm text-indigo-600/70",children:["AIã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆãŒç­†ã‚’èµ°ã‚‰ã›ã¦ã„ã¾ã™",e.jsx("br",{}),"ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„ï¼ˆç´„10-20ç§’ï¼‰"]})]}):T.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:T.map((t,r)=>e.jsxs("button",{onClick:()=>ce(t),className:"group relative aspect-square rounded-xl overflow-hidden border-2 border-transparent hover:border-indigo-500 transition-all hover:scale-105",children:[e.jsx("img",{src:t,alt:`Option ${r+1}`,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors flex items-center justify-center",children:e.jsx("span",{className:"opacity-0 group-hover:opacity-100 bg-white text-indigo-600 text-xs font-bold px-3 py-1 rounded-full shadow-lg transform translate-y-2 group-hover:translate-y-0 transition-all",children:"ã“ã‚Œã«ã™ã‚‹"})})]},r))}):e.jsx("div",{className:"text-center py-8 text-stone-500",children:"ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦ãŠè©¦ã—ãã ã•ã„ã€‚"})}),!O&&T.length>0&&e.jsxs("div",{className:"p-4 bg-stone-50 border-t border-stone-200 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>I(!1),className:"px-4 py-2 text-stone-500 font-bold text-sm hover:text-stone-700",children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"}),e.jsxs("button",{onClick:()=>B(p.find(t=>t.id===$)),className:"px-6 py-2 bg-indigo-600 text-white font-bold text-sm rounded-lg hover:bg-indigo-700 shadow-lg flex items-center gap-2",children:[e.jsx(A,{size:16})," å†ç”Ÿæˆã™ã‚‹"]})]})]})})]})}export{Ee as default};
