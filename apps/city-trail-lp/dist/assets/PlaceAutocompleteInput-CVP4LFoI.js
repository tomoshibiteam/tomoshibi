import{r as t,j as s}from"./index-VJX5zWq_.js";import{b as C}from"./index.modern-DWtZusUZ.js";const I=({onPlaceSelect:b,placeholder:w="Search for a place",className:j,defaultValue:p="",value:l,onValueChange:O})=>{const c=l!==void 0,[g,i]=t.useState(p);t.useEffect(()=>{c&&l!==g&&i(l)},[l,c]),t.useEffect(()=>{c||i(p)},[p,c]);const[x,m]=t.useState([]),[y,o]=t.useState(!1),a=C("places"),[v,E]=t.useState(null),[h,P]=t.useState(null),[u,S]=t.useState(null),_=t.useRef(null),f=t.useRef(null);t.useEffect(()=>{a&&(E(new a.AutocompleteService),P(new a.PlacesService(document.createElement("div"))),S(new a.AutocompleteSessionToken))},[a]),t.useEffect(()=>{const e=n=>{f.current&&!f.current.contains(n.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const k=e=>{const n=e.target.value;if(i(n),!n.trim()||!v||!u){m([]),o(!1);return}v.getPlacePredictions({input:n,sessionToken:u,language:"ja",componentRestrictions:{country:"jp"}},(r,d)=>{d===google.maps.places.PlacesServiceStatus.OK&&r?(m(r),o(!0)):(m([]),o(!1))})},N=(e,n)=>{i(n),o(!1),h&&u&&h.getDetails({placeId:e,fields:["geometry","formatted_address","name","place_id"],sessionToken:u},(r,d)=>{d===google.maps.places.PlacesServiceStatus.OK&&r&&(b(r),a&&S(new a.AutocompleteSessionToken))})};return s.jsxs("div",{className:"relative",ref:f,children:[s.jsx("input",{ref:_,type:"text",value:g,onChange:k,placeholder:w,className:j,autoComplete:"off"}),y&&x.length>0&&s.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white rounded-xl shadow-lg border border-stone-200 overflow-hidden max-h-60 overflow-y-auto",children:x.map(e=>s.jsxs("button",{onClick:()=>N(e.place_id,e.description),className:"w-full text-left px-4 py-3 hover:bg-brand-base transition-colors flex flex-col gap-0.5 border-b border-stone-100 last:border-0",children:[s.jsx("span",{className:"text-sm font-bold text-brand-dark max-w-full truncate",children:e.structured_formatting.main_text}),s.jsx("span",{className:"text-xs text-stone-500 max-w-full truncate",children:e.structured_formatting.secondary_text})]},e.place_id))}),s.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:s.jsx("img",{src:"https://maps.gstatic.com/mapfiles/api-3/images/powered-by-google-on-white3.png",alt:"Powered by Google",className:"h-4 w-auto opacity-75"})})]})};export{I as P};
