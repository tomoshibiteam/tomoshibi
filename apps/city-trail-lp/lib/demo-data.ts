/**
 * Layton-Style Quest Demo Data
 * 
 * ■ 修正版コンセプト：「影踏み侍と三つの遺言」
 * 
 * 0. 数字・計算禁止 - 言葉、状況判断、物理現象を利用
 * 1. 世界観重視 - 鎌倉の情景とリンクした情緒的な謎
 * 2. 外部知識不要 - すべて資料に答えの種がある
 * 3. 報酬 - 背景理解（Lore）と物語の鍵（Plot Key）
 */

export interface BasicInfo {
    title: string;
    description: string;
    area: string;
    difficulty: string;
    tags: string[];
}

export interface StoryData {
    castName: string;
    castTone: string;
    prologueTitle: string;
    prologueBody: string;
    epilogueBody: string;
    characters: { id: string; name: string; role: string; color: string; tone: string; motivation?: string; sampleDialogue?: string }[];
}

export interface LaytonSpotData {
    id: string;
    name: string;
    address: string;
    lat: number;
    lng: number;
    directions: string;
    storyText: string;
    challengeText: string;
    hints: string[];
    answer: string;
    successMessage: string;
    playerHandout?: string;
    solutionSteps?: string[];
    loreReveal?: string;
    plotKey?: string;
    puzzleType?: string;
    sceneRole?: string;
    linkingRationale?: string;
}

export const DEMO_BASIC_INFO: BasicInfo = {
    title: '鎌倉・影踏み侍の遺言',
    description: '「私の影を探してくれ」──不思議な手紙に導かれ、あなたは光と影が交錯する古都・鎌倉を彷徨う。',
    area: '鎌倉',
    difficulty: '謎解き・中級',
    tags: ['ミステリー', '歴史ロマン', '没入型'],
};

export const DEMO_STORY: StoryData = {
    castName: '影踏み侍',
    castTone: '静かで哲学的、少し寂しげ',
    prologueTitle: '影のない男',
    prologueBody: `夕暮れの鎌倉駅。人混みの中で、奇妙な男とすれ違った。
古風な着物を着たその男には、足元に"影"がなかった。

男は一通の手紙をあなたに手渡し、煙のように消えた。

「私の影が逃げてしまった。
　影は、主人の心の形をしているという。
　三つの場所を巡り、私の影＝心を捕まえてほしい。

　最初の場所は、神の使いが舞う宮。鶴岡八幡宮だ。」`,
    epilogueBody: `三つの謎を解き、あなたは真実にたどり着いた。

「影」とは、過去の記憶。そして歴史そのもの。
私たちは誰もが、過去という長い影を背負って生きている。

侍の声が聞こえた気がした。
「ありがとう。これで私も、歴史の一部として眠ることができる...」

振り向くと、あなたの足元には、夕陽に長く伸びる自分の影だけがあった。`,
    characters: [
        { id: 'c1', name: '影踏み侍', role: '依頼人', color: 'bg-stone-800', tone: '古風', motivation: '自分の影（生きた証）を取り戻したい', sampleDialogue: '影はどこへ行った...' },
    ],
};

export const DEMO_SPOTS: LaytonSpotData[] = [
    // ═══════════════════════════════════════════════════════════════
    // スポット1: 鶴岡八幡宮
    // テーマ：視点の転換（上を見る）
    // ═══════════════════════════════════════════════════════════════
    {
        id: 'spot-0',
        name: '鶴岡八幡宮',
        address: '神奈川県鎌倉市雪ノ下2-1-31',
        lat: 35.3269,
        lng: 139.5565,
        directions: '鎌倉駅東口から若宮大路を直進、徒歩10分',
        sceneRole: '導入（視点）',

        storyText: `大きな鳥居の下に来た。
侍の手紙には、こう書かれている。

「人は皆、前ばかり見て歩く。
　だから大切なものを見落とすのだ。
　立ち止まり、上を見上げよ。
　そこにあるものが、最初の鍵だ。」`,

        playerHandout: `【侍のスケッチ】

鳥居を下から見上げた図が描かれている。
しかし、鳥居の上の空に、不思議な線が引かれている。

　　＿＿＿＿＿＿（空）
　　　　│
　　　　│

スケッチの横のメモ：
「鳥居（Torii）の上にあるもの。
　それは、地（Earth）の対義語。
　青く、広く、どこまでも続くもの。」`,

        challengeText: `【第一の謎】

鳥居の上にあるもの。
地の対義語。

漢字一文字で答えよ。`,

        hints: [
            '鳥居の上には何が広がっていますか？',
            '「地」の反対は？「天」とも言いますが、普段見る青いものは？',
            '答えは「空」です。',
        ],

        answer: '空',

        successMessage: `正解！「空」だ。

ふと見上げると、鎌倉の青い空が広がっていた。
広大で、何も遮るものがない自由な心。

侍の声が響く。
「そうだ。私の心は、かつてあの空のように自由だった...」

第一の鍵「空」を手に入れた。`,

        solutionSteps: [
            '「鳥居の上」を見上げる',
            '「地」の対義語を考える',
            '青く広いもの = 「空」',
        ],

        loreReveal: '鶴岡八幡宮の参道（若宮大路）は、海から宮へと一直線に伸びている。空と海と神をつなぐ道だ。',
        plotKey: '空',

        puzzleType: '連想・視点',
        linkingRationale: '視線を上げることで「空」を認識させる、物理的な没入体験',
    },

    // ═══════════════════════════════════════════════════════════════
    // スポット2: 鎌倉大仏
    // テーマ：なぞなぞ（リドル）
    // ═══════════════════════════════════════════════════════════════
    {
        id: 'spot-1',
        name: '高徳院（鎌倉大仏）',
        address: '神奈川県鎌倉市長谷4-2-28',
        lat: 35.3168,
        lng: 139.5357,
        directions: '江ノ電「長谷駅」から徒歩7分',
        sceneRole: '転換（解釈）',

        storyText: `大仏の前に来ると、侍の気配が濃くなった。
手紙の続きが浮かび上がる。

「私は口があるが、語らない。
　耳があるが、聞かない。
　
　だが、想いを伝える術を持っている。
　大仏様もまた、同じ術を使っている。」`,

        playerHandout: `【仏像の解説図】

大仏の姿勢についてのメモ：

・目は半眼（半分閉じている）
・口は結んでいる（語らない）
・**手**は印を結んでいる（定印）

解説：
「仏は言葉を使わず、**手**の形（印）で意志や悟りを人々に伝える。」`,

        challengeText: `【第二の謎】

口を使わずに想いを伝える体の部位。
大仏が印を結んでいる部位。

「掴む」「握る」「離す」動作をするもの。

漢字一文字で答えよ。`,

        hints: [
            '解説図をよく読んでください。「仏は〇〇の形で意志を伝える」',
            '物を掴んだり、握手をする体の部分は？',
            '答えは「手」です。',
        ],

        answer: '手',

        successMessage: `正解！「手」だ。

大仏の手の形（印）には、深い意味が込められている。
言葉よりも雄弁に、その手は慈悲を語っている。

侍の声：
「私の手は...かつて刀を握っていた。だが今は、誰かと繋ぐために使いたいのだ」

第二の鍵「手」を手に入れた。`,

        solutionSteps: [
            '解説図を読む：「手」の形で意志を伝えるとある',
            '口を使わない伝達手段 = 手話やジェスチャー = 手',
            '答え：手',
        ],

        loreReveal: '鎌倉大仏の印は「上品上生印（じょうぼんじょうしょういん）」という、最高の悟りを表す形をしている。',
        plotKey: '手',

        puzzleType: 'リドル（なぞなぞ）',
        linkingRationale: '大仏の特徴的な「印」に注目させ、手の意味を考えさせる',
    },

    // ═══════════════════════════════════════════════════════════════
    // スポット3: 稲村ヶ崎
    // テーマ：物理現象・メタ（統合）
    // ═══════════════════════════════════════════════════════════════
    {
        id: 'spot-2',
        name: '稲村ヶ崎',
        address: '神奈川県鎌倉市稲村ガ崎1丁目',
        lat: 35.3043,
        lng: 139.5217,
        directions: '江ノ電「稲村ヶ崎駅」から徒歩5分',
        sceneRole: '真実（統合）',

        storyText: `夕陽が沈む海岸。ここが旅の終点だ。
侍の手紙が、最後の輝きを放つ。

「二つの鍵『空』と『手』を持て。
　そして太陽に背を向けよ。

　空に向かって手をかざした時、
　地面に生まれる『もう一人の私』。
　それが最後の答えだ。」`,

        playerHandout: `【光と形の法則】

１．光源（太陽）がある。
２．遮るもの（手）がある。
３．反対側（地面）に、黒い形が現れる。

この現象を何と呼ぶか？

数式：
光 ＋ 物体 ＝ 〇〇`,

        challengeText: `【最後の謎】

これまで集めた鍵：
１．空（背景となる場所）
２．手（遮るもの）

太陽の下、空に手をかざすと、地面にできる黒い形。
侍がずっと探していた「失われたもの」。

漢字一文字で答えよ。`,

        hints: [
            '光があるところに必ずできるもの',
            '夕方になると長く伸びるもの',
            '侍が探していたのは自分の「影」です',
        ],

        answer: '影',

        successMessage: `正解！「影」だ。

あなたが手をかざすと、地面に手の影が落ちた。
それと重なるように、着物姿の侍の影が現れた。

「ありがとう。影があるということは、そこに光があり、私が存在している証だ」

侍の影は、あなたの影と一瞬だけ重なり、そして夕闇に溶けていった。
鎌倉の波音が、優しく響いていた。`,

        solutionSteps: [
            '条件を確認：太陽＋手＋地面',
            '現象を想像：光を遮るとできるもの',
            '物語の目的を想起：侍は「影」を探していた',
            '答え：影',
        ],

        loreReveal: '稲村ヶ崎はかつて激戦の地（死の場所）だったが、今は美しい夕日（生の輝き）の名所。光と影が同居する場所だ。',
        plotKey: '影',

        puzzleType: '物理・メタ統合',
        linkingRationale: '過去の鍵（空・手）を物理的なアクション（かざす）で統合し、タイトル回収（影）へ',
    },
];

export const isDevMode = (): boolean => {
    return import.meta.env.DEV || false;
};
